<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>情绪导向景点推荐</title>
    <link rel="stylesheet" href="css/style.css">
</head>
<body>
    <!-- 主应用页面 -->
    <div id="app-page" class="page">
        <!-- 顶部导航栏 -->
        <header class="app-header">
            <div class="header-content">
                <h2 class="logo">情绪旅行</h2>
                <div class="header-actions">
                    <button id="history-btn" class="btn btn-icon" title="历史记录">
                        <span>📋</span>
                    </button>
                    <button id="settings-btn" class="btn btn-icon" title="设置">
                        <span>⚙️</span>
                    </button>
                </div>
            </div>
        </header>

        <!-- 步骤指示器 -->
        <div class="steps-indicator">
            <div class="step-item" data-step="1">
                <div class="step-number">1</div>
                <div class="step-label">情绪输入</div>
            </div>
            <div class="step-item" data-step="2">
                <div class="step-number">2</div>
                <div class="step-label">基础信息</div>
            </div>
            <div class="step-item" data-step="3">
                <div class="step-number">3</div>
                <div class="step-label">AI问答</div>
            </div>
            <div class="step-item" data-step="4">
                <div class="step-number">4</div>
                <div class="step-label">推荐结果</div>
            </div>
        </div>

        <main class="app-main">
            <!-- 步骤1：情绪输入区域 -->
            <div id="step-1" class="step-content active">
                <div class="step-header">
                    <h2>分享您的心情</h2>
                    <p>上传图片、音频、视频或输入文字，让我们了解您想要的旅行氛围</p>
                </div>

                <div class="input-tabs">
                    <button class="input-tab active" data-input-type="image">📷 图片</button>
                    <button class="input-tab" data-input-type="audio">🎵 音频</button>
                    <button class="input-tab" data-input-type="video">🎬 视频</button>
                    <button class="input-tab" data-input-type="text">✍️ 文字</button>
                </div>

                <!-- 图片上传区域 -->
                <div id="input-image" class="input-panel active">
                    <div class="upload-area" id="image-upload-area">
                        <div class="upload-content">
                            <span class="upload-icon">📷</span>
                            <p>拖拽图片到此处或点击选择</p>
                            <p class="upload-hint">支持 JPG、PNG、GIF 格式，最多5张</p>
                        </div>
                        <input type="file" id="image-input" multiple accept="image/*" hidden>
                    </div>
                    <div id="image-preview" class="preview-container"></div>
                </div>

                <!-- 音频上传区域 -->
                <div id="input-audio" class="input-panel">
                    <div class="upload-area" id="audio-upload-area">
                        <div class="upload-content">
                            <span class="upload-icon">🎵</span>
                            <p>拖拽音频到此处或点击选择</p>
                            <p class="upload-hint">支持 MP3、WAV 格式</p>
                        </div>
                        <input type="file" id="audio-input" accept="audio/*" hidden>
                    </div>
                    <div id="audio-preview" class="preview-container"></div>
                </div>

                <!-- 视频上传区域 -->
                <div id="input-video" class="input-panel">
                    <div class="upload-area" id="video-upload-area">
                        <div class="upload-content">
                            <span class="upload-icon">🎬</span>
                            <p>拖拽视频到此处或点击选择</p>
                            <p class="upload-hint">支持 MP4、WebM 格式</p>
                        </div>
                        <input type="file" id="video-input" accept="video/*" hidden>
                    </div>
                    <div id="video-preview" class="preview-container"></div>
                </div>

                <!-- 文本输入区域 -->
                <div id="input-text" class="input-panel">
                    <div class="text-input-area">
                        <textarea id="text-input" placeholder="描述您想要的旅行氛围，例如：想要一个安静、自然、有山水的地方放松心情..."></textarea>
                    </div>
                </div>

                <button id="analyze-btn" class="btn btn-primary btn-large" disabled>分析情绪</button>
                
                <div id="keywords-display" class="keywords-container hidden">
                    <h3>提取的情绪关键词：</h3>
                    <div id="keywords-list" class="keywords-list"></div>
                    <button id="step1-next" class="btn btn-primary">下一步</button>
                </div>
            </div>

            <!-- 步骤2：理性问题收集区域 -->
            <div id="step-2" class="step-content">
                <div class="step-header">
                    <h2>出行信息</h2>
                    <p>请填写基本的出行信息</p>
                </div>

                <form id="questionnaire-form" class="questionnaire-form">
                    <div class="form-group">
                        <label for="travel-date">出行日期</label>
                        <input type="date" id="travel-date" required>
                    </div>

                    <div class="form-group">
                        <label for="travel-time">出行时间</label>
                        <select id="travel-time" required>
                            <option value="">请选择</option>
                            <option value="morning">上午</option>
                            <option value="afternoon">下午</option>
                            <option value="evening">晚上</option>
                            <option value="night">夜间</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label for="traveler-count">出行人数</label>
                        <input type="number" id="traveler-count" min="1" required>
                    </div>

                    <div class="form-group">
                        <label for="departure-location">出发地点</label>
                        <input type="text" id="departure-location" placeholder="例如：北京市朝阳区" required>
                    </div>

                    <div class="form-actions">
                        <button type="button" id="step2-back" class="btn btn-secondary">上一步</button>
                        <button type="submit" class="btn btn-primary">下一步</button>
                    </div>
                </form>
            </div>

            <!-- 步骤3：AI个性化问答区域 -->
            <div id="step-3" class="step-content">
                <div class="step-header">
                    <h2>AI个性化问答</h2>
                    <p>AI会根据您的信息提出个性化问题，帮助更好地推荐</p>
                </div>

                <div class="chat-container">
                    <div id="chat-messages" class="chat-messages">
                        <div class="chat-message assistant">
                            <div class="message-content">
                                <p>正在分析您的信息，准备个性化问题...</p>
                            </div>
                        </div>
                    </div>

                    <div class="chat-input-area">
                        <input type="text" id="chat-input" placeholder="输入您的回答..." disabled>
                        <button id="chat-send-btn" class="btn btn-primary" disabled>发送</button>
                    </div>

                    <div class="chat-actions">
                        <button id="skip-chat-btn" class="btn btn-secondary">跳过</button>
                        <button id="finish-chat-btn" class="btn btn-primary" disabled>完成</button>
                    </div>
                </div>

                <div class="step-actions">
                    <button id="step3-back" class="btn btn-secondary">上一步</button>
                </div>
            </div>

            <!-- 步骤4：推荐结果区域 -->
            <div id="step-4" class="step-content">
                <div class="step-header">
                    <h2>推荐结果</h2>
                    <p>为您精心挑选的景点推荐</p>
                </div>

                <div id="loading-indicator" class="loading-container">
                    <div class="spinner"></div>
                    <p>正在生成推荐...</p>
                </div>

                <div id="recommendations-container" class="recommendations-container hidden">
                    <!-- 景点推荐卡片将动态插入这里 -->
                </div>

                <div class="step-actions">
                    <button id="step4-back" class="btn btn-secondary">上一步</button>
                    <button id="new-search-btn" class="btn btn-primary">重新搜索</button>
                </div>
            </div>
        </main>

        <!-- 我的计划区域（侧边栏） -->
        <div id="plans-sidebar" class="sidebar hidden">
            <div class="sidebar-header">
                <h3>我的计划</h3>
                <button id="close-plans-btn" class="btn btn-icon">✕</button>
            </div>
            <div id="plans-list" class="plans-list">
                <!-- 计划列表将动态插入这里 -->
            </div>
        </div>

        <!-- 历史记录侧边栏 -->
        <div id="history-sidebar" class="sidebar hidden">
            <div class="sidebar-header">
                <h3>历史记录</h3>
                <button id="close-history-btn" class="btn btn-icon">✕</button>
            </div>
            <div id="history-list" class="history-list">
                <!-- 历史记录列表将动态插入这里 -->
            </div>
        </div>

        <!-- 设置面板 -->
        <div id="settings-panel" class="modal hidden">
            <div class="modal-content">
                <div class="modal-header">
                    <h3>设置</h3>
                    <button id="close-settings-btn" class="btn btn-icon">✕</button>
                </div>
                <div class="modal-body">
                    <div class="settings-section">
                        <h4>API配置</h4>
                        <div class="form-group">
                            <label>智谱API密钥</label>
                            <input type="password" id="zhipu-api-key" placeholder="输入您的智谱API密钥">
                        </div>
                        <div class="form-group">
                            <label>地图API密钥</label>
                            <input type="password" id="map-api-key" placeholder="输入您的地图API密钥">
                        </div>
                        <div class="form-group">
                            <label>天气API密钥</label>
                            <input type="password" id="weather-api-key" placeholder="输入您的天气API密钥">
                        </div>
                        <button id="save-api-config" class="btn btn-primary">保存配置</button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- 图片放大模态框 -->
    <div id="image-modal" class="modal hidden">
        <div class="modal-content image-modal-content">
            <button id="close-image-modal" class="btn btn-icon modal-close">✕</button>
            <img id="modal-image" src="" alt="">
        </div>
    </div>

    <!-- 脚本文件 -->
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <script src="js/supabase.js"></script>
    <script src="js/auth.js"></script>
    <script src="js/input-handler.js"></script>
    <script src="js/ai-processor.js"></script>
    <script src="js/map-api.js"></script>
    <script src="js/recommendation.js"></script>
    <script src="js/reviews-processor.js"></script>
    <script src="js/questionnaire.js"></script>
    <script src="js/weather-api.js"></script>
    <script src="js/nearby-info.js"></script>
    <script src="js/travel-recommendation.js"></script>
    <script src="js/ai-chat.js"></script>
    <script src="js/history.js"></script>
    <script src="js/app.js"></script>
</body>
</html>

